{
  "version": "1.0",
  "project": {
    "name": "samuel",
    "description": "Autonomous pilot mode - AI-discovered tasks",
    "created_at": "2026-02-21T15:51:24Z",
    "updated_at": "2026-02-21T17:45:00Z"
  },
  "config": {
    "max_iterations": 30,
    "quality_checks": [
      "go test ./...",
      "go vet ./...",
      "go build ./..."
    ],
    "ai_tool": "claude",
    "ai_prompt_file": ".claude/auto/prompt.md",
    "sandbox": "none",
    "pilot_mode": true,
    "pilot_config": {
      "discover_interval": 5,
      "max_discovery_tasks": 10
    },
    "discovery_prompt_file": ".claude/auto/discovery-prompt.md"
  },
  "tasks": [
    {
      "id": "1",
      "title": "Fix silent error handling in init.go, doctor.go, and search.go",
      "description": "Three places silently discard errors with `_`: init.go:250 discards error from ScanSkillsDirectory, doctor.go:95 discards error from os.ReadFile, search.go:57 discards error from LoadConfig. These should log warnings or return errors to avoid hiding failures.",
      "status": "completed",
      "commit_sha": "c3c55622c25dc2efd3c9b16b150ab02282aa2e58",
      "priority": "high",
      "complexity": "low",
      "files_to_modify": [
        "internal/commands/init.go",
        "internal/commands/doctor.go",
        "internal/commands/search.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "2",
      "title": "Remove unused extractor variable in doctor.go",
      "description": "At doctor.go:387-398, an extractor is instantiated but never used, with the warning silenced via `_ = extractor`. Either use it for the intended purpose or remove the dead code.",
      "status": "pending",
      "priority": "medium",
      "complexity": "low",
      "files_to_modify": [
        "internal/commands/doctor.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "3",
      "title": "Add unit tests for internal/github/client.go",
      "description": "The internal/github package has 0% test coverage. client.go (279 LOC) handles GitHub API calls for releases, tags, and archives. Add tests with HTTP test server mocking for key functions.",
      "status": "completed",
      "commit_sha": "b98b986",
      "priority": "high",
      "complexity": "medium",
      "files_to_modify": [
        "internal/github/client_test.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "4",
      "title": "Add unit tests for internal/core/skill.go",
      "description": "skill.go (431 LOC) handles skill parsing, loading, validation, and indexing with no test coverage. This is core business logic that needs tests for ParseSkillFile, ValidateSkill, ScanSkillsDirectory, and related functions.",
      "status": "completed",
      "commit_sha": "16771cf",
      "priority": "high",
      "complexity": "medium",
      "files_to_modify": [
        "internal/core/skill_test.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "5",
      "title": "Add unit tests for internal/core/auto_tasks.go",
      "description": "auto_tasks.go (213 LOC) manages task state transitions and persistence with no test coverage. Add table-driven tests for task status changes, filtering, and edge cases.",
      "status": "completed",
      "commit_sha": "3c73231",
      "priority": "high",
      "complexity": "medium",
      "files_to_modify": [
        "internal/core/auto_tasks_test.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "6",
      "title": "Refactor runDoctor() into smaller helper functions",
      "description": "runDoctor() in doctor.go spans 362 lines (lines 45-407), far exceeding the 50-line guardrail. Extract each health check into separate functions (checkConfig, checkCLAUDEMD, checkSkillsIntegrity, etc.) and extract auto-fix logic into performAutoFix().",
      "status": "pending",
      "priority": "medium",
      "complexity": "medium",
      "files_to_modify": [
        "internal/commands/doctor.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "7",
      "title": "Refactor runInit() into smaller helper functions",
      "description": "runInit() in init.go spans 277 lines (lines 41-318), far exceeding the 50-line guardrail. Extract into helper functions: selectTemplate(), selectLanguages(), selectFrameworks(), downloadAndExtract(), and postInitSetup().",
      "status": "pending",
      "priority": "medium",
      "complexity": "medium",
      "files_to_modify": [
        "internal/commands/init.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "8",
      "title": "Add unit tests for internal/core/downloader.go",
      "description": "downloader.go (262 LOC) handles GitHub archive download and tar extraction with no test coverage. This is critical I/O logic. Add tests using temp directories and mock HTTP responses.",
      "status": "completed",
      "commit_sha": "e07b37c",
      "priority": "high",
      "complexity": "medium",
      "files_to_modify": [
        "internal/core/downloader_test.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "9",
      "title": "Add unit tests for internal/core/auto_prompt.go",
      "description": "auto_prompt.go (104 LOC) generates prompts for the autonomous AI loop with no test coverage. Add tests for prompt template rendering and edge cases.",
      "status": "pending",
      "priority": "medium",
      "complexity": "low",
      "files_to_modify": [
        "internal/core/auto_prompt_test.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "10",
      "title": "Reduce file size of internal/core/skill.go below 300-line limit",
      "description": "skill.go is 431 lines, exceeding the 300-line guardrail for non-test files. Extract skill validation logic into skill_validate.go and/or skill parsing into skill_parse.go to bring each file under the limit.",
      "status": "pending",
      "priority": "low",
      "complexity": "medium",
      "files_to_modify": [
        "internal/core/skill.go",
        "internal/core/skill_validate.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "11",
      "title": "Fix symlink traversal vulnerability in tar extraction",
      "description": "In downloader.go:124-133, symlink targets (header.Linkname) are not validated during tar extraction. A malicious archive could contain a symlink pointing outside the destination directory (e.g., ../../etc/shadow), allowing subsequent file writes through the symlink to arbitrary locations. Validate that resolved symlink targets stay within the destination directory.",
      "status": "completed",
      "commit_sha": "1cf9484",
      "priority": "critical",
      "complexity": "low",
      "files_to_modify": [
        "internal/core/downloader.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "12",
      "title": "Fix nil pointer dereference in CheckForUpdates",
      "description": "In client.go:216-228, GetLatestRelease can return (nil, nil) when no releases exist (line 90-92). CheckForUpdates accesses release.TagName without a nil check, causing a panic. Add a nil guard: if release == nil, return an error.",
      "status": "completed",
      "commit_sha": "e484979",
      "priority": "critical",
      "complexity": "low",
      "files_to_modify": [
        "internal/github/client.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "13",
      "title": "Add path traversal validation to extractor.go file operations",
      "description": "ReadFile, WriteFile, RemoveFile, and BackupFile in extractor.go accept a path parameter and join it with destPath, but never validate the result stays within the destination directory. A path like '../../etc/passwd' would escape. Add filepath.Clean + strings.HasPrefix containment checks to all four functions.",
      "status": "completed",
      "commit_sha": "8b69661",
      "priority": "high",
      "complexity": "low",
      "files_to_modify": [
        "internal/core/extractor.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "14",
      "title": "Add size limits to tar extraction and file downloads",
      "description": "In downloader.go:117-121, io.Copy has no size limit during tar extraction (decompression bomb risk). In client.go:204-206, io.ReadAll reads entire HTTP response without limit (OOM risk). Add io.LimitReader with reasonable max sizes (e.g., 100MB per extracted file, 10MB per downloaded file).",
      "status": "completed",
      "commit_sha": "050f9f6",
      "priority": "high",
      "complexity": "low",
      "files_to_modify": [
        "internal/core/downloader.go",
        "internal/github/client.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "15",
      "title": "Fix silently discarded filepath.Walk errors in diff.go",
      "description": "In diff.go:201 and diff.go:223, filepath.Walk return values are discarded with `_ =`. If the walk encounters errors (permission denied, concurrent deletion), diff results will be silently incomplete. Also fix discarded filepath.Glob error at diff.go:192. Handle errors or propagate them to callers.",
      "status": "pending",
      "priority": "medium",
      "complexity": "low",
      "files_to_modify": [
        "internal/commands/diff.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "16",
      "title": "Add unit tests for internal/core/extractor.go",
      "description": "extractor.go (378 LOC) has ~15% coverage with 13 of 17 functions at 0%. This file handles tar extraction, file I/O, backup/restore — critical operations. Add tests for Extract, ExtractAll, shouldSkip, ValidateExtraction, FileExists, ReadFile, WriteFile, RemoveFile, BackupFile, RestoreBackup using t.TempDir().",
      "status": "completed",
      "commit_sha": "fbc447e",
      "priority": "high",
      "complexity": "medium",
      "files_to_modify": [
        "internal/core/extractor_test.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "17",
      "title": "Add unit tests for internal/ui/output.go",
      "description": "output.go (137 LOC) has 0% coverage. It contains 14 formatting functions (Success, Error, Warn, Info, Print, Bold, Dim, Header, Section, ListItem, etc.) that are the most testable of the UI files. Test by capturing stdout and verifying output format. Also test DisableColors toggle.",
      "status": "pending",
      "priority": "medium",
      "complexity": "low",
      "files_to_modify": [
        "internal/ui/output_test.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "18",
      "title": "Refactor runUpdate() into smaller helper functions",
      "description": "runUpdate() in update.go spans 220 lines (lines 41-261), which is 4.4x the 50-line guardrail limit — the worst violation after runDoctor and runInit. Extract into helpers: checkForUpdate(), downloadUpdate(), applyUpdate(), handleComponentMerge(), and displayUpdateSummary().",
      "status": "pending",
      "priority": "medium",
      "complexity": "medium",
      "files_to_modify": [
        "internal/commands/update.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "19",
      "title": "Add unit tests for registry.go skill lookup functions",
      "description": "registry.go has ~85% coverage but 6 skill-related lookup functions at 0%: FindSkill, GetAllSkillNames, GetLanguageSkills, SkillToLanguageName, GetFrameworkSkills, GetWorkflowSkills. Add table-driven tests to cover these pure functions. These are simple data lookups that should be easy to test.",
      "status": "pending",
      "priority": "medium",
      "complexity": "low",
      "files_to_modify": [
        "internal/core/registry_test.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "20",
      "title": "Reduce file size of internal/core/sync.go below 300-line limit",
      "description": "sync.go is 431 lines, exceeding the 300-line guardrail. Extract CLAUDE.md generation logic into sync_generate.go and/or folder scanning logic into sync_scan.go. The SyncFolderCLAUDEMDs function (60 lines) and related helpers can be logically grouped to bring each file under the limit.",
      "status": "pending",
      "priority": "low",
      "complexity": "medium",
      "files_to_modify": [
        "internal/core/sync.go",
        "internal/core/sync_generate.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "21",
      "title": "Fix TOCTOU vulnerability in AITool validation for auto loop",
      "description": "In auto_loop.go:116, cfg.AITool is passed directly to exec.Command without validation. While parseAutoFlags() calls core.IsValidAITool() at CLI parse time, the PRD file is re-read from disk at each loop iteration (auto_loop.go:74), so a modified prd.json could inject an arbitrary binary path between validation and execution. Add IsValidAITool() check inside invokeAgentLocal() before exec.Command.",
      "status": "completed",
      "commit_sha": "4db5316",
      "priority": "critical",
      "complexity": "low",
      "files_to_modify": [
        "internal/core/auto_loop.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "22",
      "title": "Add path containment validation to RestoreBackup and CopyFromCache",
      "description": "In extractor.go:319-338, RestoreBackup computes dstPath = filepath.Join(e.destPath, relPath) without calling validateContainedPath, allowing a crafted backup directory to write outside the destination. Similarly, CopyFromCache (line 358+) and helpers copyDirRecursive/copySingleFile lack path containment checks. Add validateContainedPath calls to both RestoreBackup and CopyFromCache for defense-in-depth consistency with ReadFile/WriteFile/RemoveFile.",
      "status": "completed",
      "commit_sha": "4f77da2",
      "priority": "high",
      "complexity": "low",
      "files_to_modify": [
        "internal/core/extractor.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "23",
      "title": "Fix silently discarded LoadAutoPRD errors in auto pilot commands",
      "description": "Four places silently discard LoadAutoPRD errors with `_ :=`: auto_pilot.go:196, auto_pilot.go:225, auto_start_handler.go:124, auto_pilot_output.go:45. When PRD loading fails mid-loop, the code proceeds with nil checks but loses the error context. Log warnings via ui.Warn for non-critical paths (printLoopSummary, printPilotSummary) and return errors for critical paths (pilot loop iteration logic).",
      "status": "pending",
      "priority": "high",
      "complexity": "low",
      "files_to_modify": [
        "internal/commands/auto_pilot.go",
        "internal/commands/auto_start_handler.go",
        "internal/commands/auto_pilot_output.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "24",
      "title": "Replace deprecated filepath.Walk with filepath.WalkDir across codebase",
      "description": "8 uses of filepath.Walk (deprecated since Go 1.16) exist in 3 files: downloader.go (lines 209, 276), extractor.go (lines 120, 146, 310, 373), diff.go (lines 201, 223). filepath.WalkDir avoids unnecessary os.Lstat calls and is the recommended replacement. Update callback signatures from func(path string, info os.FileInfo, err error) to func(path string, d fs.DirEntry, err error), using d.Info() only where FileInfo fields are needed.",
      "status": "pending",
      "priority": "medium",
      "complexity": "low",
      "files_to_modify": [
        "internal/core/downloader.go",
        "internal/core/extractor.go",
        "internal/commands/diff.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "25",
      "title": "Fix silently discarded filepath.Rel errors in extractor.go",
      "description": "Three calls to filepath.Rel in extractor.go silently discard errors: line 87 (Extract), line 104 (Extract directory case), line 117 (ExtractAll). If filepath.Rel fails, relPath becomes empty string, which could cause incorrect file path construction or misleading log output. Handle the error by returning it or logging a warning.",
      "status": "pending",
      "priority": "medium",
      "complexity": "low",
      "files_to_modify": [
        "internal/core/extractor.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "26",
      "title": "Add unit tests for auto_loop.go agent invocation functions",
      "description": "auto_loop.go has 5 functions at 0% coverage: InvokeAgent, invokeAgentLocal, invokeAgentDocker, invokeAgentDockerSandbox, buildDockerRunArgs. buildDockerRunArgs is a pure function that constructs Docker CLI arguments — easily testable with table-driven tests. InvokeAgent dispatches based on sandbox mode — test the dispatch logic. The exec.Command functions can be tested by verifying argument construction without actually executing.",
      "status": "pending",
      "priority": "high",
      "complexity": "medium",
      "files_to_modify": [
        "internal/core/auto_loop_test.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "27",
      "title": "Add unit tests for config.go path and value functions",
      "description": "config.go has 4 functions below 50% coverage: GetGlobalConfigPath (0%), GetCachePath (0%), EnsureCacheDir (0%), GetValue (45%). These path functions use os.UserHomeDir/os.UserCacheDir — test using environment variable overrides or mock. GetValue needs tests for nested key access (e.g., 'installed.languages') and error cases for unknown keys. Add table-driven tests to fill these coverage gaps.",
      "status": "pending",
      "priority": "medium",
      "complexity": "low",
      "files_to_modify": [
        "internal/core/config_test.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "28",
      "title": "Reduce file size of internal/core/config.go below 300-line limit",
      "description": "config.go is 425 lines, exceeding the 300-line guardrail by 42%. Extract path-related functions (GetGlobalConfigPath, GetCachePath, EnsureCacheDir — lines 289-332) and key-value functions (GetValue, SetValue, GetAllValues, splitAndTrim — lines 335-425) into config_paths.go and config_values.go respectively.",
      "status": "pending",
      "priority": "low",
      "complexity": "medium",
      "files_to_modify": [
        "internal/core/config.go",
        "internal/core/config_paths.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "29",
      "title": "Reduce file size of internal/core/registry.go below 300-line limit",
      "description": "registry.go is 460 lines, exceeding the 300-line guardrail by 53% — the largest non-test file in the codebase. Extract skill lookup functions (FindSkill, GetAllSkillNames, GetLanguageSkills, SkillToLanguageName, GetFrameworkSkills, GetWorkflowSkills) into registry_skills.go. The data definitions and component lookups can stay in registry.go.",
      "status": "pending",
      "priority": "low",
      "complexity": "medium",
      "files_to_modify": [
        "internal/core/registry.go",
        "internal/core/registry_skills.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "30",
      "title": "Reduce file size of internal/core/extractor.go below 300-line limit",
      "description": "extractor.go is 413 lines, exceeding the 300-line guardrail by 38%. Recent additions (validateContainedPath, path traversal checks) have increased the file size. Extract backup/restore functions (BackupFile, RestoreBackup, GetSourcePath, GetDestPath — lines 280-345) and cache copy functions (CopyFromCache, copyDirRecursive, copySingleFile — lines 355-413) into extractor_backup.go.",
      "status": "pending",
      "priority": "low",
      "complexity": "medium",
      "files_to_modify": [
        "internal/core/extractor.go",
        "internal/core/extractor_backup.go"
      ],
      "source": "pilot-discovery"
    }
  ],
  "progress": {
    "total_tasks": 30,
    "completed_tasks": 12,
    "current_iteration": 12,
    "total_iterations_run": 12,
    "status": "in_progress"
  }
}

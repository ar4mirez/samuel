{
  "version": "1.0",
  "project": {
    "name": "samuel",
    "description": "Autonomous pilot mode - AI-discovered tasks",
    "created_at": "2026-02-21T21:55:56Z",
    "updated_at": "2026-02-22T06:30:00Z"
  },
  "config": {
    "max_iterations": 30,
    "quality_checks": [
      "go test ./...",
      "go vet ./...",
      "go build ./..."
    ],
    "ai_tool": "claude",
    "ai_prompt_file": ".claude/auto/prompt.md",
    "sandbox": "none",
    "pilot_mode": true,
    "pilot_config": {
      "discover_interval": 5,
      "max_discovery_tasks": 10
    },
    "discovery_prompt_file": ".claude/auto/discovery-prompt.md"
  },
  "tasks": [
    {
      "id": "61",
      "title": "Fix unchecked file.Close() errors after io.Copy in downloader.go and extractor.go",
      "description": "downloader.go lines 168, 171, 255 and extractor.go line 415 call file.Close() or defer dst.Close() without checking the error after io.Copy writes. On some filesystems, Close() is when buffered data is flushed to disk. A failed Close() means silently corrupted extracted files. Fix by checking Close() error and returning it (for non-deferred) or using a named return + deferred error check pattern.",
      "status": "completed",
      "priority": "high",
      "complexity": "medium",
      "files_to_modify": [
        "internal/core/downloader.go",
        "internal/core/extractor.go"
      ],
      "commit_sha": "a53222d",
      "source": "pilot-discovery"
    },
    {
      "id": "62",
      "title": "Add Docker sandbox image name validation in auto_loop.go",
      "description": "SandboxImage from prd.json (user-editable) is passed directly to docker run without validation (auto_loop.go:146). A tampered prd.json could specify a malicious Docker image. Add an IsValidSandboxImage() function that validates image names match a safe pattern (e.g., alphanumeric with dots, dashes, colons, slashes for registry/image:tag format) and rejects shell metacharacters or absolute paths.",
      "status": "completed",
      "priority": "medium",
      "complexity": "low",
      "files_to_modify": [
        "internal/core/auto_loop.go",
        "internal/core/docker.go"
      ],
      "commit_sha": "8f60188",
      "source": "pilot-discovery"
    },
    {
      "id": "63",
      "title": "Add unit tests for doctor_checks.go check functions",
      "description": "doctor_checks.go (291 LOC) was created by the task 6 refactor of runDoctor() but has 0% test coverage. Contains 8 exported check functions (checkConfigFile, checkCLAUDEMD, checkAGENTSMD, checkDirectoryStructure, checkInstalledComponents, checkSkillsIntegrity, checkAutoHealth, checkLocalModifications) plus the generic checkInstalledSkills helper. Use t.TempDir() with crafted project directory structures to test each check function independently.",
      "status": "completed",
      "priority": "medium",
      "complexity": "high",
      "files_to_modify": [
        "internal/commands/doctor_checks_test.go"
      ],
      "commit_sha": "5782ea2",
      "source": "pilot-discovery"
    },
    {
      "id": "64",
      "title": "Add unit tests for init_steps.go step functions",
      "description": "init_steps.go (284 LOC) was created by the task 7 refactor of runInit() but has 0% test coverage. Contains testable functions: parseInitFlags (struct extraction from cobra command), validateInitTarget (directory validation), downloadFramework (delegates to downloader). Focus on parseInitFlags and validateInitTarget which are pure-ish functions testable without mocking.",
      "status": "completed",
      "priority": "medium",
      "complexity": "medium",
      "files_to_modify": [
        "internal/commands/init_steps_test.go"
      ],
      "commit_sha": "",
      "source": "pilot-discovery"
    },
    {
      "id": "65",
      "title": "Add unit tests for commands/update.go helper logic",
      "description": "update.go (264 LOC) has 0% test coverage and contains the largest function in the codebase (runUpdate at 219 lines). While runUpdate itself is hard to unit test (orchestration), look for extractable pure functions or test the file comparison logic. At minimum, test the string-to-bytes comparison pattern and the file categorization logic.",
      "status": "pending",
      "priority": "medium",
      "complexity": "high",
      "files_to_modify": [
        "internal/commands/update_test.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "66",
      "title": "Refactor runSkillInfo() in commands/skill.go below 50-line limit",
      "description": "runSkillInfo() is 92 lines (1.84x the 50-line limit) at skill.go:284. Extract helper functions for: (1) skill lookup and SKILL.md path resolution, (2) metadata display formatting, (3) file preview rendering. This also helps reduce skill.go (375 lines) closer to the 300-line file limit.",
      "status": "pending",
      "priority": "medium",
      "complexity": "medium",
      "files_to_modify": [
        "internal/commands/skill.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "67",
      "title": "Refactor runAutoStart() in auto_start_handler.go below 50-line limit",
      "description": "runAutoStart() is 80 lines (1.6x the 50-line limit) at auto_start_handler.go:12. Extract helper functions for: (1) flag parsing and config population, (2) PRD loading and validation, (3) loop configuration assembly. The function mixes flag parsing, PRD loading, config building, and loop invocation which should be separated.",
      "status": "pending",
      "priority": "medium",
      "complexity": "medium",
      "files_to_modify": [
        "internal/commands/auto_start_handler.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "68",
      "title": "Add URL scheme validation for registry config value in config_cmd.go",
      "description": "The 'config set registry' command accepts any string without URL format validation (config_cmd.go:162-175). A malicious or accidental registry URL (e.g., http:// instead of https://, or a non-URL string) could redirect future downloads to untrusted sources. Add validation that the registry value is a valid HTTPS URL when the key is 'registry'.",
      "status": "pending",
      "priority": "medium",
      "complexity": "low",
      "files_to_modify": [
        "internal/commands/config_cmd.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "69",
      "title": "Replace deprecated filepath.Walk with filepath.WalkDir in core package",
      "description": "8 uses of deprecated filepath.Walk remain in the codebase (6 in extractor.go, 2 in downloader.go). filepath.WalkDir (available since Go 1.16) is more efficient because it provides fs.DirEntry instead of os.FileInfo, avoiding unnecessary Lstat calls. Replace all 8 uses in the core package, updating callback signatures from (path string, info os.FileInfo, err error) to (path string, d fs.DirEntry, err error). Call d.Info() only where FileInfo fields are actually needed.",
      "status": "pending",
      "priority": "low",
      "complexity": "medium",
      "files_to_modify": [
        "internal/core/extractor.go",
        "internal/core/downloader.go"
      ],
      "source": "pilot-discovery"
    },
    {
      "id": "70",
      "title": "Extract magic numbers to named constants in skill.go and ui/prompts.go",
      "description": "Several magic numbers should be named constants for clarity: skill.go:281-282 uses 80/77 for description truncation, prompts.go:30 uses 10 for prompt list size, prompts.go:92 uses 12 for multi-select list size, spinner.go:25 uses 14 for spinner type, spinner.go:85 uses 40 for progress bar width. Extract each to a descriptively named package-level constant.",
      "status": "pending",
      "priority": "low",
      "complexity": "low",
      "files_to_modify": [
        "internal/core/skill.go",
        "internal/ui/prompts.go",
        "internal/ui/spinner.go"
      ],
      "source": "pilot-discovery"
    }
  ],
  "progress": {
    "total_tasks": 10,
    "completed_tasks": 4,
    "current_iteration": 28,
    "total_iterations_run": 28,
    "status": "in_progress"
  }
}
